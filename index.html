<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KZN-NYE 25/26 Destination Vote</title>
    <style>
        :root { --bg: linear-gradient(135deg, #667eea, #764ba2); --card: rgba(255,255,255,0.12); --accent: #ff6b6b; }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: var(--bg);
            color: #fff;
            min-height: 100vh;
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
            padding-bottom: 90px;
        }
        header { padding: 30px 20px; background: rgba(0,0,0,0.3); }
        h1 { font-size: 2em; margin-bottom: 10px; }
        .subtitle { font-size: 1.1em; opacity: 0.9; }
        .destinations { padding: 20px; display: grid; gap: 28px; }
        .card {
            background: var(--card);
            border-radius: 20px;
            padding: 22px;
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .card img {
            width: 100%;
            height: 220px;
            object-fit: cover;
            border-radius: 16px;
            margin-bottom: 12px;
        }
        .card h2 { font-size: 1.7em; margin: 10px 0; }
        .card p { margin: 10px 0; line-height: 1.5; }
        .card ul { text-align: left; max-width: 480px; margin: 14px auto; padding-left: 20px; }
        .card li { margin: 8px 0; }
        .pros li::marker { content: "‚úÖ "; color: #4ecdc4; }
        .cons li::marker { content: "‚ö†Ô∏è "; color: #ff6b6b; }
        .vote-btn {
            width: 100%;
            padding: 18px;
            margin: 20px 0 8px;
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            border: none;
            border-radius: 50px;
            color: white;
            font-size: 1.4em;
            font-weight: bold;
            cursor: pointer;
        }
        .vote-btn.voted { background: #555; cursor: not-allowed; }
        #results {
            margin: 30px 20px;
            padding: 25px;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
        }
        .progress-bar {
            height: 26px;
            background: rgba(255,255,255,0.2);
            border-radius: 13px;
            overflow: hidden;
            margin: 12px 0;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
            transition: width 0.8s ease;
        }
        .share {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            padding: 20px;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
        }
        .share-btn {
            background: #1da1f2;
            color: white;
            padding: 16px 40px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-size: 1.2em;
            display: inline-block;
        }
        #confetti { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; }
        #thanks {
            position:fixed; top:0; left:0; width:100%; height:100%;
            background:rgba(0,0,0,0.92); color:white;
            display:none; justify-content:center; align-items:center;
            flex-direction:column; font-size:2em; z-index:99999;
        }
        a { color: #4ecdc4; }
    </style>
</head>
<body>

<header>
    <h1>KZN-NYE 25/26 Destination Vote</h1>
    <p class="subtitle">7‚Äì10 people ‚Ä¢ 31 Dec 2025 ‚Äì 2 Jan 2026 ‚Ä¢ KZN South Coast<br>R1200‚ÄìR1400 p/p (2 nights + food/drinks)</p>
</header>

<section class="destinations" id="destinations"></section>

<section id="results">
    <h2>Live Results</h2>
    <div id="progress-container"></div>
</section>

<div class="share">
    <a href="#" id="share" class="share-btn">Copy Share Link</a>
</div>

<canvas id="confetti"></canvas>
<div id="thanks">
    <div>Vote Received! üéâ</div>
    <div style="font-size:0.6em;margin-top:20px;">Thanks ‚Äî watch the results update live</div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyATZipoJembfjyTrvay0XeGDeOoMXpwyIg",
      authDomain: "kzn-nye25.firebaseapp.com",
      databaseURL: "https://kzn-nye25-default-rtdb.firebaseio.com",
      projectId: "kzn-nye25",
      storageBucket: "kzn-nye25.firebasestorage.app",
      messagingSenderId: "644646652528",
      appId: "1:644646652528:web:0312c427dfe3d10f2f42b5"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const votesRef = ref(db, 'votes');

    let votes = {};
    let total = 0;

    onValue(votesRef, (snap) => {
        votes = snap.val() || {};
        total = Object.values(votes).filter(v=>v).length;
        updateResults();
    });

    const places = [
        {
            id: "mantis",
            name: "Mantis & Moon Backpackers",
            area: "Umzumbe",
            img: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&fit=crop",
            cost: "R1200‚ÄìR1350 pp",
            vibe: "Jungle surf lodge ‚Äì bar, hot tub, wild NYE party",
            nye: "DJ, bonfire & fireworks on the lawn ‚Ä¢ R50 cover",
            type: "Backpackers lodge",
            sleeping: "Cabins & rooms for 7‚Äì10",
            energy: "High",
            beach: "5-min walk",
            amenities: "Pool, hot tub, bar, WiFi, braai, yoga",
            pros: ["Epic jungle bar & social vibe", "Hot tub nights", "Surf lessons available", "Group-friendly", "Unique architecture"],
            cons: ["Can get loud at night", "Basic facilities in some rooms", "Wildlife encounters"],
            fun: "Party hard with DJs & bonfires; chill with yoga & beach days. Ideal for adventurous groups.",
            link: "https://www.mantisandmoon.net/"
        },
        {
            id: "spot",
            name: "The Spot Backpackers",
            area: "Margate",
            img: "https://images.unsplash.com/photo-1519046904884-53103b34b206?w=800&fit=crop",
            cost: "R1150‚ÄìR1300 pp",
            vibe: "Beachfront hostel ‚Äì sun, sea, casual hangs",
            nye: "Free street party spillover + ocean fireworks",
            type: "Hostel with cabins",
            sleeping: "Log cabins & dorms for 7‚Äì10",
            energy: "Medium-High",
            beach: "Direct access",
            amenities: "Bar, kitchen, braai areas, sea views",
            pros: ["Direct beach access", "Budget-friendly", "Close to nightlife", "Secure parking"],
            cons: ["Shared bathrooms", "Can feel basic"],
            fun: "Beach days, braais, then Margate bars. Great for relaxed group vibes turning lively.",
            link: "https://www.thespotbackpackers.co.za/"
        },
        {
            id: "umkobi",
            name: "Umkobi Lodge",
            area: "Southbroom",
            img: "https://images.unsplash.com/photo-1571003118755-17e458abfb60?w=800&fit=crop",
            cost: "R1250‚ÄìR1400 pp",
            vibe: "Cozy log cabins ‚Äì lagoon views, peaceful escape",
            nye: "Sunset braai & nearby fireworks (R100 cover optional)",
            type: "Self-catering log cabins",
            sleeping: "3-bed houses (sleeps 6-8, multiple units)",
            energy: "Medium",
            beach: "10-min walk to Trafalgar Beach",
            amenities: "Terrace, air-con, secure complex, braai",
            pros: ["Stunning lagoon/ocean views", "Secure & tranquil", "Self-catering kitchen", "Near golf/spa"],
            cons: ["Limited on-site partying", "Walk to main beach", "No WiFi"],
            fun: "Kayak the lagoon, braai evenings, explore nearby beaches. Balanced for chill groups.",
            link: "https://www.airbnb.com/rooms/18304337"
        },
        {
            id: "santorini",
            name: "Santorini Village",
            area: "Ramsgate",
            img: "https://cf.bstatic.com/xdata/images/hotel/max1024x768/448273217.jpg?k=3b5b5d0a5e0e0e0e0e0e0e0e0e0e0e0e0e0e0e0e&k=3b5b5d0a5e0e0e0e0e0e0e0e0e0e0e0e0e0e0e0e",
            cost: "R1300‚ÄìR1400 pp",
            vibe: "Greek-inspired apartments ‚Äì seafront luxury",
            nye: "Ramsgate beach bash 2 mins away ‚Ä¢ DJs & fireworks ‚Ä¢ R150 cover",
            type: "Self-catering apartments",
            sleeping: "3-bed units (6-9 people, book multiple)",
            energy: "High",
            beach: "Direct beachfront",
            amenities: "Pool, balconies, braai, garage, WiFi",
            pros: ["Panoramic sea views", "Modern & comfortable", "Pool area", "Walk to restaurants"],
            cons: ["Peak premium pricing", "Shared facilities"],
            fun: "Balcony sundowners to beach parties. Perfect for style & nightlife lovers.",
            link: "https://www.booking.com/hotel/za/santorini-village-ramsgate.en-gb.html"
        },
        {
            id: "happy",
            name: "Happy Wanderers Resort",
            area: "Illovo",
            img: "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&fit=crop",
            cost: "R1200‚ÄìR1350 pp",
            vibe: "Family resort ‚Äì beachfront, on-site fun",
            nye: "Resort party with live music & fireworks ‚Ä¢ R80 cover",
            type: "Cabins & apartments",
            sleeping: "4-bed units (sleeps 8-10)",
            energy: "High",
            beach: "Direct access (meters away)",
            amenities: "Restaurant, bar, pools, shop, games room",
            pros: ["All-in-one site", "On-site dining", "Private beach", "Family/group activities"],
            cons: ["Monkeys as pests", "Busy with families"],
            fun: "Pool lounging, bar nights, beach games. Easy, no-drive group holiday.",
            link: "https://happywanderers.co.za/"
        },
        {
            id: "cutty",
            name: "Premier Resort Cutty Sark",
            area: "Scottburgh",
            img: "https://cf.bstatic.com/xdata/images/hotel/max1024x768/510000000.jpg?k=somehash",
            cost: "R1200‚ÄìR1400 pp",
            vibe: "Beach hotel ‚Äì ocean views, resort amenities",
            nye: "Gala dinner, DJ & beach fireworks ‚Ä¢ R200 cover",
            type: "Sea-facing rooms",
            sleeping: "Multiple rooms for 7‚Äì10",
            energy: "Medium-High",
            beach: "Direct access to main beach",
            amenities: "Outdoor pool, bar, restaurant, WiFi, playground",
            pros: ["Direct beach & views", "On-site bar/restaurant", "Free parking", "Clean & manicured grounds"],
            cons: ["Some dated elements", "Family-oriented crowds"],
            fun: "Poolside cocktails, scuba nearby, evening entertainment. Comfort for mixed groups.",
            link: "https://www.booking.com/hotel/za/cutty-sark-scottburgh.html"
        }
    ];

    const cont = document.getElementById('destinations');
    places.forEach(p => {
        const prosHtml = p.pros.map(x => `<li>${x}</li>`).join('');
        const consHtml = p.cons.map(x => `<li>${x}</li>`).join('');
        cont.innerHTML += `
            <div class="card">
                <img src="${p.img}" alt="${p.name}" loading="lazy">
                <h2>${p.name}<br><small>${p.area}</small></h2>
                <p><strong>${p.cost}</strong> ‚Ä¢ ${p.vibe}</p>
                <p><strong>NYE:</strong> ${p.nye}</p>
                <p><strong>Type:</strong> ${p.type} ‚Ä¢ <strong>Sleeps:</strong> ${p.sleeping} ‚Ä¢ <strong>Energy:</strong> ${p.energy} ‚Ä¢ <strong>Beach:</strong> ${p.beach}</p>
                <p><strong>Amenities:</strong> ${p.amenities}</p>
                <ul class="pros"><strong>Pros:</strong>${prosHtml}</ul>
                <ul class="cons"><strong>Cons:</strong>${consHtml}</ul>
                <p><strong>Fun Factor:</strong> ${p.fun}</p>
                <p>Book: <a href="${p.link}" target="_blank">${p.link.replace('https://www.', '').split('.')[0].toUpperCase()}</a></p>
                <button class="vote-btn" data-id="${p.id}">Vote for ${p.name}!</button>
            </div>`;
    });

    document.addEventListener('click', async e => {
        if (e.target.classList.contains('vote-btn')) {
            if (localStorage.getItem('kzn-voted')) {
                alert('You already voted ‚Äî thank you!');
                return;
            }
            const id = e.target.dataset.id;
            try {
                await set(ref(db, 'votes/' + Date.now()), id);
                localStorage.setItem('kzn-voted', 'true');
                e.target.textContent = 'Voted! üéâ';
                e.target.classList.add('voted');
                confetti();
                const thanks = document.getElementById('thanks');
                thanks.style.display = 'flex';
                setTimeout(() => thanks.style.display = 'none', 3000);
            } catch (error) {
                alert('Vote failed‚Äîcheck connection or Firebase rules.');
            }
        }
    });

    function updateResults() {
        const c = document.getElementById('progress-container');
        c.innerHTML = '';
        places.forEach(p => {
            const count = Object.values(votes).filter(v => v === p.id).length;
            const pct = total ? Math.round((count / total) * 100) : 0;
            c.innerHTML += `
                <p><strong>${p.name}</strong> ‚Äî ${count} votes</p>
                <div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div>
            `;
        });
    }

    // Share link button
    document.getElementById('share').onclick = e => {
        e.preventDefault();
        navigator.clipboard.writeText(location.href).then(() => {
            const btn = e.target;
            const orig = btn.textContent;
            btn.textContent = 'Copied!';
            setTimeout(() => btn.textContent = orig, 2000);
        });
    };

    // Confetti animation
    function confetti() {
        const canvas = document.getElementById('confetti');
        const ctx = canvas.getContext('2d');
        canvas.width = innerWidth;
        canvas.height = innerHeight;
        const pieces = [];
        for (let i = 0; i < 200; i++) {
            pieces.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                s: Math.random() * 6 + 3,
                vx: (Math.random() - 0.5) * 8,
                vy: Math.random() * 5 + 5,
                c: `hsl(${Math.random() * 360}, 80%, 60%)`
            });
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            pieces.forEach(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.2;
                p.rotation = (p.rotation || 0) + 0.1;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rotation);
                ctx.fillStyle = p.c;
                ctx.fillRect(-5, -10, 10, 20);
                ctx.restore();
                if (p.y > canvas.height) p.y = -20;
            });
            if (pieces.some(p => p.y < canvas.height)) requestAnimationFrame(draw);
        }
        draw();
    }

    updateResults();
</script>
</body>
</html>

